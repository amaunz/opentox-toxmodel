%p
  = link_to "New prediction", "/predict"
.predictions
  %table
    %tr
      %th{:colspan => @predictions.size+1}
        = @identifier
    %tr
      %th
        %img{:src => @compound.image_uri, :alt => @compound.smiles}
      - @predictions.each do |p|
        %td
          %b
            = p[:title] + ":"
          - if p[:measured_activities]
            %br
            - p[:measured_activities].each do |a|
              - if activity(a) == 'active'
                .active
                  = activity(a)
              - elsif activity(a) == 'inactive'
                .inactive
                  = activity(a)
              - else
                = a
            %br
              (
              %a{:href => "#", :id => "linkTrainingData#{p.object_id}"} Training data
              :javascript
                $("a#linkTrainingData#{p.object_id}").click(function () {
                  $("dl#training_data").toggle();  
                });
              )

          - else
            - if activity(p[:prediction]) == 'active'
              .active
                = activity(p[:prediction])
            - elsif activity(p[:prediction]) == 'inactive'
              .inactive
                = activity(p[:prediction])
            - elsif p[:prediction].is_a?(Float)
              .other
                = sprintf('%.03g', p[:prediction])
            - else
              .other
                %em= p[:prediction].to_s
            - if p[:confidence]
              %br
                (
                %a{:href => "#", :id => "linkConfidence#{p.object_id}"} Confidence
                = ": #{sprintf('%.03g', p[:confidence].to_f.abs)}"
                :javascript
                  $("a#linkConfidence#{p.object_id}").click(function () {
                    $("dl#confidence").toggle();  
                  });
                )

%dl#confidence{ :style => "display: none;" }
  %dt Confidence:
  %dd Indicates the applicability domain of a model. Predictions with a high confidence can be expected to be more reliable than predictions with low confidence. Confidence values may take any value between 0 and 1. For most models confidence &gt; 0.025 is a sensible (hard) cutoff to distiguish between reliable and unreliable predictions.


%dl#training_data{ :style => "display: none;" }
  %dt Training data:
  %dd Experimental result(s) from the training dataset are displayed here. 


